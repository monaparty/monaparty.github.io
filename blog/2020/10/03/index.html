<!doctype html><html class=no-js lang=en-us><head><meta charset=utf-8><meta charset=utf-8><meta name=description content="Monaparty crypto-assets platform"><meta name=author content="Themefisher"><meta name=generator content="Hugo 0.71.1"><meta name=format-detection content="telephone=no"><meta name=viewport content="width=device-width,initial-scale=1"><title>How to upgrade Monaparty federated node.</title><link rel=icon href=https://monaparty.me/images/favicon.ico><link rel=stylesheet href=https://monaparty.me/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://monaparty.me/plugins/ionicons/ionicons.min.css><link rel=stylesheet href=https://monaparty.me/plugins/animate-css/animate.css><link rel=stylesheet href=https://monaparty.me/plugins/slider/slider.css><link rel=stylesheet href=https://monaparty.me/plugins/slick/slick.css><link rel=stylesheet href=https://monaparty.me/plugins/facncybox/jquery.fancybox.css><link rel=stylesheet href=https://monaparty.me/plugins/hover/hover-min.css><link rel=stylesheet href=https://monaparty.me/css/style.min.css integrity media=screen></head><body><section class="top-bar animated-header"><div class=container><div class=row><div class=col-lg-12><nav class="navbar navbar-expand-lg navbar-light bg-light"><a class=navbar-brand href=https://monaparty.me/><img src=https://monaparty.me/images/logo.png alt=logo></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://monaparty.me/>Home</a></li><li class=nav-item><a class=nav-link href=/service>Service Nodes</a></li><li class=nav-item><a class=nav-link href=/protocol-changes>Protocol Changes</a></li><li class=nav-item><a class=nav-link href=/blog>Blog</a></li></div></nav></div></div></div></section><section class=global-page-header><div class=container><div class=row><div class=col-md-12><div class=block><h2>How to upgrade Monaparty federated node.</h2><div class=portfolio-meta><span>Saturday, Oct 3, 2020</span>|
<span>Tags:</span></div></div></div></div></div></section><section class=single-post><div class=container><div class=row><div class=col-md-12><div class=post-content><p>Hello, Monaparty node administrators.</p><p>How about your happy Monapaty festa in autumn?</p><p>This article describes how to upgrade your federated node.</p><h1 id=why-special->Why special ?</h1><p>&ldquo;Node upgrade in fall, 2020&rdquo; is a big upgrade.
So you must do some more tasks than usual.</p><h1 id=step-by-step>Step by Step</h1><h2 id=uninstall-older-version>Uninstall older version</h2><pre><code>fednode uninstall
</code></pre><p>Don&rsquo;t worry. Docker volumes is kept back.</p><h2 id=switch-your-branch-to-monaparty-and-pull-commits>Switch your branch to <code>monaparty</code> and pull commits.</h2><pre><code>cd fednode/
git checkout monaparty
git pull
</code></pre><p>Finally federated node supports <code>monaparty</code> (means the stable master) branch.
I strongly recommend run your nodes with this branch.</p><p>Of course, you can keep using <code>monaparty-develop</code>. But it&rsquo;s a breeding edge.</p><h2 id=check-configuration>Check configuration</h2><pre><code>fednode configcheck
</code></pre><p>Brand-new <code>indexd-server</code> support is added in this upgrade.
So there will be some differences between your configuration and official&rsquo;s.</p><p>Please fix them.</p><p>You may use <code>for i in config/*/*.default; do cp $i $(dirname $i)/$(basename $i .default); done</code> if you see it.</p><h2 id=install-new-nodes>Install new nodes.</h2><pre><code>fednode install full master
</code></pre><p>In case you don&rsquo;t want to install Counterwallet, you can use <code>fednode install counterblock master</code>
or <code>fednode install base master</code> instead.</p><h2 id=update-nodes>Update nodes.</h2><pre><code>fednode Update
</code></pre><p>In this version of fednode have some bugs.
So you must run update command.</p><p>In horrible, the update process is finished with an error like this.</p><pre><code>Fatal error: Invalid checksum: src/vendors/bitcoinjs-lib/bitcoinjs.min.js
</code></pre><p>But. It&rsquo;s OK for now even if you might not believe me. Trust.</p><h2 id=just-wait-for-2-or-3-days>Just wait for 2 or 3 days.</h2><p>The database will run full re-parse. It will required 2 or 3 days.</p><h2 id=extra-in-case-re-parse-was-stopped-with-inconsistency>extra: In case re-parse was stopped with inconsistency.</h2><p>In some cases, re-parse may be stopped with the transaction inconsistency.</p><p>You can resolve this by deleting old databases.</p><p>Here is the step-by-step.</p><h3 id=stop-counterparty-servers>Stop Counterparty servers</h3><pre><code>fednode stop counterparty
fednode stop counterparty-testnet
</code></pre><h3 id=check-the-local-path-for-the-volume>Check the local path for the volume</h3><pre><code>docker volume inspect federatednode_counterparty-data
</code></pre><p>You will get result like this.</p><pre><code>[
    {
        &quot;CreatedAt&quot;: &quot;2020-10-01T05:54:04Z&quot;,
        &quot;Driver&quot;: &quot;local&quot;,
        &quot;Labels&quot;: null,
        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/federatednode_counterparty-data/_data&quot;,
        &quot;Name&quot;: &quot;federatednode_counterparty-data&quot;,
        &quot;Options&quot;: null,
        &quot;Scope&quot;: &quot;local&quot;
    }
]
</code></pre><p><code>"Mountpoint"</code> is the target.</p><h3 id=remove-database-related-files>Remove database related files</h3><pre><code>sudo sh -c 'rm /var/lib/docker/volumes/federatednode_counterparty-data/_data/monaparty.db*'
</code></pre><p>The path should be arranged to fit your environment.</p><h2 id=restart-servers>Restart servers</h2><pre><code>fednode start counterparty
fednode start counterparty-testnet
</code></pre><h2 id=pray>Pray</h2><p>The latest database image may be downloaded if you are lucky. :-)</p><p>If you aren&rsquo;t, the full re-parse process may be run. ;-)
Please wait for 2 or 3 days.</p></div></div></div></div></section><section id=call-to-action><div class=container><div class=row><div class=col-md-12><div class=block><h2 class="title wow fadeInDown" data-wow-delay=.3s data-wow-duration=500ms>WANT TO START YOUR MONAPARTY LIFE ?</h1><p class="wow fadeInDown" data-wow-delay=.5s data-wow-duration=500ms>The first step is to create your wallet. One of the easiest way is to use Counterwallet-mona, our official wallet.</p><a href=https://wallet.monaparty.me/ class="btn btn-default btn-contact wow fadeInDown" data-wow-delay=.7s data-wow-duration=500ms>Start Monaparty with Counterwallet-mona</a></div></div></div></div></section><footer id=footer><div class=container><div class="row content-justify-between"><div class="col-md-8 col-12 text-center text-lg-left text-md-left"><p class=copyright>Copyright:
<span><script>document.write(new Date().getFullYear())</script></span>Articles by Monaparty Project</p><p class=copyright>Copyright:
<span>2017</span> Header image is by にゃんたろう八段 (CC-BY-SA 4.0)</p><p class=copyright>Copyright:
<span><script>document.write(new Date().getFullYear())</script></span>Design and Developed by
<a href=http://www.Themefisher.com target=_blank>Themefisher</a>.<br>Get More Bootstrap Template From Our
<a href=https://themefisher.com/free-bootstrap-templates/ target=_blank>Store</a></p></div><div class="col-md-4 col-12"><ul class="social text-center text-md-right text-lg-right"><li><a href=https://twitter.com/MonapartyXMP class=twitter><i class=ion-social-twitter></i></a></li><li><a href=https://github.com/Monaparty/ class=github><i class=ion-social-github></i></a></li></ul></div></div></div><div class=container><div class="row content-justify-between"><div class="col-md-12 col-12 text-center text-lg-left text-md-left">This site is using Cookie and Google Analytics.</div></div></div></footer><script src=https://monaparty.me/plugins/jQurey/jquery.min.js></script><script src=https://monaparty.me/plugins/form-validation/jquery.form.js></script><script src=https://monaparty.me/plugins/form-validation/jquery.validate.min.js></script><script src=https://monaparty.me/plugins/slick/slick.min.js></script><script src=https://monaparty.me/plugins/bootstrap/bootstrap.min.js></script><script src=https://monaparty.me/plugins/wow-js/wow.min.js></script><script src=https://monaparty.me/plugins/slider/slider.js></script><script src=https://monaparty.me/plugins/facncybox/jquery.fancybox.js></script><script src=https://monaparty.me/js/script.min.js></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-52736825-3','auto');ga('send','pageview');</script></body></html>